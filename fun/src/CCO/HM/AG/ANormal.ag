module{CCO.HM.AG.ANormal}{}{}
imports
{
import CCO.HM.AG.BaseHelpers
}

-------------------------------------------------------------------------------
-- AST
-------------------------------------------------------------------------------

data AVal
  | ANat     i :: {Int}
  | AVar     x :: {Var}
  | AField   x :: {Var}  i :: {Int}

type AVals = [AVal]

data AExp
  | AVal     v :: AVal
  | AApp     e :: AExp   v :: AVal
  | AIf      c :: AVal   t1 :: ATm  t2 :: ATm
  | ALam     xs :: {[Var]}  t :: ATm
  | AAlloc   tag :: {Int}  vs :: AVals
  | APrim    op :: {String} vs :: AVals
  | AForce   e :: AExp

data ATm
  | AExp     e :: AExp
  | ALet     x :: {Var}  e :: AExp t :: ATm
